<!DOCTYPE HTML>

<html>
    <head>
        <meta charset="UTF-8">
        <title>
            Demo
        </title>
        <script type="text/javascript" src="elm-runtime.js">
            
        </script>
        <script type="text/javascript">
            Elm.Demo = function (elm)
           {
             if (elm.Demo)
             return elm.Demo;
             var N = Elm.Native,
                 _N = N.Utils(elm),
                 _L = N.List(elm),
                 _E = N.Error(elm),
                 _J = N.JavaScript(elm),
                 _str = _J.toString,
                 $moduleName = "Demo";
             var Text = Elm.Text(elm);
             var Text = Elm.Text(elm);
             var Basics = Elm.Basics(elm);
             var Signal = Elm.Signal(elm);
             var List = Elm.List(elm);
             var Maybe = Elm.Maybe(elm);
             var Time = Elm.Time(elm);
             var Prelude = Elm.Prelude(elm);
             var Graphics = Graphics || {};
             Graphics.Element = Elm.Graphics.Element(elm);
             var Color = Elm.Color(elm);
             var Graphics = Graphics || {};
             Graphics.Collage = Elm.Graphics.Collage(elm);
             var Either = Elm.Either(elm);
             var Dict = Elm.Dict(elm);
             var Dict = Elm.Dict(elm);
             var Physics = Elm.Physics(elm);
             var Draw = Elm.Draw(elm);
             var Public = Public || {};
             Public.State = Public.State || {};
             Public.State.State = Elm.Public.State.State(elm);
             var Step = Elm.Step(elm);
             var GameInputs = Elm.GameInputs(elm);
             var Types = Elm.Types(elm);
             var Utils = Elm.Utils(elm);
             var Public = Public || {};
             Public.Vec2 = Public.Vec2 || {};
             Public.Vec2.Vec2 = Elm.Public.Vec2.Vec2(elm);
             var Main = Elm.Main(elm);
             var ShipWright = Elm.ShipWright(elm);
             var _op = {};
             var spine = A2(Types.beam,{_: {}, r: 200},_J.toList([]));
             var station = {_: {}, cache: Physics.genEntityCache(spine), controls: Either.Right(_J.toList([])), motion: {_: {}, omega: 0, pos: {_: {}, theta: 0, x: 0, y: 200}, v: {_: {}, x: 0, y: 0}}};
             var initialShips = _J.toList([{_: {}, cache: Physics.genEntityCache(Main.simpleShip), controls: Either.Right(_J.toList([])), motion: {_: {}, omega: 0, pos: {_: {}, theta: 0, x: 0, y: 0}, v: {_: {}, x: 0, y: 0}}},
                                           {_: {}, cache: Physics.genEntityCache(Main.simpleShip), controls: Either.Right(_J.toList([])), motion: {_: {}, omega: 0, pos: {_: {}, theta: 1, x: 60, y: 50}, v: {_: {}, x: 0, y: 0}}},
                                           {_: {}, cache: Physics.genEntityCache(Main.simpleShip), controls: Either.Right(_J.toList([])), motion: {_: {}, omega: 0, pos: {_: {}, theta: 4, x: 0 - 80, y: 40}, v: {_: {}, x: 0, y: 0}}},
                                           {_: {}, cache: Physics.genEntityCache(Main.simpleShip), controls: Either.Right(_J.toList([])), motion: {_: {}, omega: 0, pos: {_: {}, theta: 3, x: 120, y: 0 - 20}, v: {_: {}, x: 0, y: 0}}}]);
             var initialPlacement = Maybe.Just({_: {}, id: 0, offset: 30, r: 20});
             var initialEntities = Dict.fromList({ctor: "::", _0: {ctor: "_Tuple2", _0: 4, _1: station}, _1: A2(List.zip,
                                                                                                                _J.toList([0,
                                                                                                                           1,
                                                                                                                           2,
                                                                                                                           3]),
                                                                                                                initialShips)});
             var initialBuildMode = {_: {}, entity: 4, part: Types.Engine({_: {}, config: Types.Forward, r: 10}), placement: initialPlacement};
             var initialMode = {_: {}, build: initialBuildMode, pause: false};
             var initialState = {_: {}, cache: A2(Utils.genGameStateCache,
                                                  0,
                                                  initialEntities), entities: initialEntities, focus: 0, mode: initialMode};
             var draw = F2(function (n,gs)
                           {
                             return function ()
                                    {
                                      var entities = Dict.values(gs.entities);
                                      var entityForms = A2(List.map,Draw.drawEntity(n),entities);
                                      var camera = gs.cache.camera;
                                      var cameraTransform = Public.Vec2.Vec2.vecTranslate(Public.Vec2.Vec2.negVec(camera));
                                      return _J.toList([Graphics.Collage.groupTransform(cameraTransform)(entityForms)]);
                                    }();
                           });
             var current = A3(Signal.foldp,
                              function ($)
                              {
                                return Public.State.State.execState(Step.step($));
                              },
                              initialState,
                              GameInputs.gameInputs);
             var withPhantom = A2(Signal._op["<~"],
                                  ShipWright.addPhantom,
                                  current);
             var main = Utils.combineSElems(Graphics.Element.outward)(_J.toList([A2(Signal._op["~"],
                                                                                    A2(Signal._op["<~"],
                                                                                       Utils.spaceBlack,
                                                                                       A2(Signal._op["<~"],
                                                                                          function (_)
                                                                                          {
                                                                                            return _.window;
                                                                                          },
                                                                                          GameInputs.gameInputs)),
                                                                                    A2(Signal._op["~"],
                                                                                       A2(Signal._op["<~"],
                                                                                          draw,
                                                                                          A2(Signal._op["<~"],
                                                                                             Basics.fst,
                                                                                             Time.timestamp(GameInputs.gameInputs))),
                                                                                       withPhantom)),
                                                                                 A2(Utils.combineSElems,
                                                                                    Graphics.Element.down,
                                                                                    _J.toList([A2(Signal._op["<~"],
                                                                                                  function ($)
                                                                                                  {
                                                                                                    return Graphics.Element.color(Color.white)(Text.asText($));
                                                                                                  },
                                                                                                  GameInputs.gameInputs),
                                                                                               A2(Signal._op["<~"],
                                                                                                  function ($)
                                                                                                  {
                                                                                                    return Graphics.Element.color(Color.white)(Text.asText(function (_)
                                                                                                                                                           {
                                                                                                                                                             return _.focus;
                                                                                                                                                           }($)));
                                                                                                  },
                                                                                                  current),
                                                                                               A2(Signal._op["<~"],
                                                                                                  function ($)
                                                                                                  {
                                                                                                    return Graphics.Element.color(Color.white)(Text.asText(function (_)
                                                                                                                                                           {
                                                                                                                                                             return _.mode;
                                                                                                                                                           }($)));
                                                                                                  },
                                                                                                  current),
                                                                                               A2(Signal._op["<~"],
                                                                                                  function ($)
                                                                                                  {
                                                                                                    return Graphics.Element.color(Color.white)(Text.asText($));
                                                                                                  },
                                                                                                  GameInputs.modes)]))]));
             elm.Demo = {_op: _op, spine: spine, station: station, initialShips: initialShips, initialEntities: initialEntities, initialState: initialState, initialMode: initialMode, initialPlacement: initialPlacement, initialBuildMode: initialBuildMode, current: current, withPhantom: withPhantom, draw: draw, main: main};
             return elm.Demo;
           };Elm.Step = function (elm)
           {
             if (elm.Step)
             return elm.Step;
             var N = Elm.Native,
                 _N = N.Utils(elm),
                 _L = N.List(elm),
                 _E = N.Error(elm),
                 _J = N.JavaScript(elm),
                 _str = _J.toString,
                 $moduleName = "Step";
             var Text = Elm.Text(elm);
             var Text = Elm.Text(elm);
             var Basics = Elm.Basics(elm);
             var Signal = Elm.Signal(elm);
             var List = Elm.List(elm);
             var Maybe = Elm.Maybe(elm);
             var Time = Elm.Time(elm);
             var Prelude = Elm.Prelude(elm);
             var Graphics = Graphics || {};
             Graphics.Element = Elm.Graphics.Element(elm);
             var Color = Elm.Color(elm);
             var Graphics = Graphics || {};
             Graphics.Collage = Elm.Graphics.Collage(elm);
             var Char = Elm.Char(elm);
             var Dict = Elm.Dict(elm);
             var Either = Elm.Either(elm);
             var Public = Public || {};
             Public.State = Public.State || {};
             Public.State.State = Elm.Public.State.State(elm);
             var Public = Public || {};
             Public.State = Public.State || {};
             Public.State.State = Elm.Public.State.State(elm);
             var Public = Public || {};
             Public.Vec2 = Public.Vec2 || {};
             Public.Vec2.Vec2 = Elm.Public.Vec2.Vec2(elm);
             var Types = Elm.Types(elm);
             var Utils = Elm.Utils(elm);
             var Physics = Elm.Physics(elm);
             var ShipWright = Elm.ShipWright(elm);
             var _op = {};
             var rotateFocus = function ()
                               {
                                 var pure = Public.State.State.returnS;
                                 _op[">>="] = Public.State.State.bindS;
                                 return A2(_op[">>="],
                                           Public.State.State.get,
                                           function (state)
                                           {
                                             return function ()
                                                    {
                                                      var focus = state.focus;
                                                      var newFocus = A2(Basics.mod,focus + 1,4);
                                                      var newState = _N.replace([["focus",
                                                                                  newFocus]],
                                                                                state);
                                                      return Public.State.State.put(newState);
                                                    }();
                                           });
                               }();
             var updateMode = function (m)
                              {
                                return function ()
                                       {
                                         var pure = Public.State.State.returnS;
                                         _op[">>="] = Public.State.State.bindS;
                                         return function ()
                                                {
                                                  switch (m.ctor)
                                                  {case
                                                   "Cycle" :
                                                     return rotateFocus;
                                                   case
                                                   "Pause" :
                                                     return A2(_op[">>="],
                                                               Public.State.State.get,
                                                               function (state)
                                                               {
                                                                 return function ()
                                                                        {
                                                                          var pause = Basics.not(state.mode.pause);
                                                                          var mode = state.mode;
                                                                          return Public.State.State.put(_N.replace([["mode",
                                                                                                                     _N.replace([["pause",
                                                                                                                                  pause]],
                                                                                                                                mode)]],
                                                                                                                   state));
                                                                        }();
                                                               });}
                                                  _E.Case($moduleName,"between lines 70 and 76");
                                                }();
                                       }();
                              };
             var noStep = Public.State.State.returnS({ctor: "_Tuple0"});
             var updatePhantom = function (pointer)
                                 {
                                   return function ()
                                          {
                                            var pure = Public.State.State.returnS;
                                            _op[">>="] = Public.State.State.bindS;
                                            return A2(_op[">>="],
                                                      Public.State.State.get,
                                                      function (state)
                                                      {
                                                        return function ()
                                                               {
                                                                 var relPointerV = Public.Vec2.Vec2.fromIntPair(pointer);
                                                                 var myShip = A2(Dict.lookup,
                                                                                 state.focus,
                                                                                 state.entities);
                                                                 var buildShip = A2(Dict.lookup,
                                                                                    state.mode.build.entity,
                                                                                    state.entities);
                                                                 return function ()
                                                                        {
                                                                          var _case1 = {ctor: "_Tuple2", _0: myShip, _1: buildShip};
                                                                          switch (_case1.ctor)
                                                                          {case
                                                                           "_Tuple2" :
                                                                             switch (_case1._0.ctor)
                                                                             {case
                                                                              "Just" :
                                                                                switch (_case1._1.ctor)
                                                                                {case
                                                                                 "Just" :
                                                                                   return function ()
                                                                                          {
                                                                                            var mode = state.mode;
                                                                                            var buildMode = mode.build;
                                                                                            var absPointerV = A2(Public.Vec2.Vec2.addVec,
                                                                                                                 state.cache.camera,
                                                                                                                 relPointerV);
                                                                                            var best = Maybe.Just(A2(ShipWright.bestPlacement,
                                                                                                                     absPointerV,
                                                                                                                     _case1._1._0));
                                                                                            var newBuildMode = _N.replace([["placement",
                                                                                                                            best]],
                                                                                                                          buildMode);
                                                                                            var newMode = _N.replace([["build",
                                                                                                                       newBuildMode]],
                                                                                                                     mode);
                                                                                            var newState = _N.replace([["mode",
                                                                                                                        newMode]],
                                                                                                                      state);
                                                                                            return Public.State.State.put(newState);
                                                                                          }();}}}
                                                                          return noStep;
                                                                        }();
                                                               }();
                                                      });
                                          }();
                                 };
             var gamePaused = function ()
                              {
                                var pure = Public.State.State.returnS;
                                _op[">>="] = Public.State.State.bindS;
                                return A2(_op[">>="],
                                          Public.State.State.get,
                                          function (state)
                                          {
                                            return pure(state.mode.pause);
                                          });
                              }();
             var focusControls = function (input)
                                 {
                                   return function ()
                                          {
                                            var pure = Public.State.State.returnS;
                                            _op[">>="] = Public.State.State.bindS;
                                            return A2(_op[">>="],
                                                      Public.State.State.get,
                                                      function (state)
                                                      {
                                                        return function ()
                                                               {
                                                                 var focus = state.focus;
                                                                 var entities = state.entities;
                                                                 var myShip = A2(Dict.lookup,
                                                                                 focus,
                                                                                 entities);
                                                                 return function ()
                                                                        {
                                                                          switch (myShip.ctor)
                                                                          {case
                                                                           "Just" :
                                                                             return function ()
                                                                                    {
                                                                                      var newMyShip = _N.replace([["controls",
                                                                                                                   input.engines]],
                                                                                                                 myShip._0);
                                                                                      var newEntities = A3(Dict.insert,
                                                                                                           focus,
                                                                                                           newMyShip,
                                                                                                           entities);
                                                                                      var newState = _N.replace([["entities",
                                                                                                                  newEntities]],
                                                                                                                state);
                                                                                      return Public.State.State.put(newState);
                                                                                    }();
                                                                           case
                                                                           "Nothing" :
                                                                             return noStep;}
                                                                          _E.Case($moduleName,
                                                                                  "between lines 128 and 134");
                                                                        }();
                                                               }();
                                                      });
                                          }();
                                 };
             var entityPureStep = function (e)
                                  {
                                    return function ()
                                           {
                                             var newMotion = function ()
                                                             {
                                                               var _case8 = e.controls;
                                                               switch (_case8.ctor)
                                                               {case
                                                                "Left" :
                                                                  return A2(Physics.updateBrakes,
                                                                            e.cache,
                                                                            e.motion);
                                                                case
                                                                "Right" :
                                                                  return function ()
                                                                         {
                                                                           var delta = A2(Physics.netDelta,
                                                                                          _case8._0,
                                                                                          e.cache);
                                                                           return A3(Physics.updateMotion,
                                                                                     e.cache,
                                                                                     delta,
                                                                                     e.motion);
                                                                         }();}
                                                               _E.Case($moduleName,
                                                                       "between lines 138 and 143");
                                                             }();
                                             return _N.replace([["motion",newMotion]],e);
                                           }();
                                  };
             var physicsStep = function ()
                               {
                                 var pure = Public.State.State.returnS;
                                 _op[">>="] = Public.State.State.bindS;
                                 return A2(_op[">>="],
                                           Public.State.State.get,
                                           function (state)
                                           {
                                             return function ()
                                                    {
                                                      var newEntities = A2(Dict.map,
                                                                           entityPureStep,
                                                                           state.entities);
                                                      var focus = state.focus;
                                                      var newCache = A2(Utils.genGameStateCache,
                                                                        focus,
                                                                        newEntities);
                                                      var newState = _N.replace([["entities",
                                                                                  newEntities],
                                                                                 ["cache",
                                                                                  newCache]],
                                                                                state);
                                                      return Public.State.State.put(newState);
                                                    }();
                                           });
                               }();
             var build = function ()
                         {
                           var pure = Public.State.State.returnS;
                           _op[">>="] = Public.State.State.bindS;
                           return A2(_op[">>="],
                                     Public.State.State.get,
                                     function (state)
                                     {
                                       return function ()
                                              {
                                                var _case11 = state.mode.build.placement;
                                                switch (_case11.ctor)
                                                {case
                                                 "Just" :
                                                   return noStep;
                                                 case
                                                 "Nothing" :
                                                   return noStep;}
                                                _E.Case($moduleName,"between lines 94 and 96");
                                              }();
                                     });
                         }();
             var step = function (input)
                        {
                          return function ()
                                 {
                                   var pure = Public.State.State.returnS;
                                   _op[">>="] = Public.State.State.bindS;
                                   return function ()
                                          {
                                            var _case13 = input.trigger;
                                            switch (_case13.ctor)
                                            {case
                                             "Click" :
                                               return build;
                                             case
                                             "FPS" :
                                               return A2(_op[">>="],
                                                         gamePaused,
                                                         function (paused)
                                                         {
                                                           return paused ? noStep : A2(_op[">>="],
                                                                                       focusControls(input),
                                                                                       function (arg0)
                                                                                       {
                                                                                         return function ()
                                                                                                {
                                                                                                  return physicsStep;
                                                                                                }();
                                                                                       });
                                                         });
                                             case
                                             "Modal" :
                                               return updateMode(_case13._0);
                                             case
                                             "Pointer" :
                                               return updatePhantom(_case13._0);}
                                            _E.Case($moduleName,"between lines 53 and 63");
                                          }();
                                 }();
                        };
             elm.Step = {_op: _op, gamePaused: gamePaused, noStep: noStep, step: step, updateMode: updateMode, rotateFocus: rotateFocus, build: build, updatePhantom: updatePhantom, focusControls: focusControls, entityPureStep: entityPureStep, physicsStep: physicsStep};
             return elm.Step;
           };Elm.ShipWright = function (elm)
                 {
                   if (elm.ShipWright)
                   return elm.ShipWright;
                   var N = Elm.Native,
                       _N = N.Utils(elm),
                       _L = N.List(elm),
                       _E = N.Error(elm),
                       _J = N.JavaScript(elm),
                       _str = _J.toString,
                       $moduleName = "ShipWright";
                   var Text = Elm.Text(elm);
                   var Text = Elm.Text(elm);
                   var Basics = Elm.Basics(elm);
                   var Signal = Elm.Signal(elm);
                   var List = Elm.List(elm);
                   var Maybe = Elm.Maybe(elm);
                   var Time = Elm.Time(elm);
                   var Prelude = Elm.Prelude(elm);
                   var Graphics = Graphics || {};
                   Graphics.Element = Elm.Graphics.Element(elm);
                   var Color = Elm.Color(elm);
                   var Graphics = Graphics || {};
                   Graphics.Collage = Elm.Graphics.Collage(elm);
                   var Mouse = Elm.Mouse(elm);
                   var Draw = Elm.Draw(elm);
                   var Public = Public || {};
                   Public.TagTree = Public.TagTree || {};
                   Public.TagTree.TagTree = Elm.Public.TagTree.TagTree(elm);
                   var Types = Elm.Types(elm);
                   var Utils = Elm.Utils(elm);
                   var Public = Public || {};
                   Public.Vec2 = Public.Vec2 || {};
                   Public.Vec2.Vec2 = Elm.Public.Vec2.Vec2(elm);
                   var _op = {};
                   var pointDist = F2(function (pointerV,bp)
                                      {
                                        return function ()
                                               {
                                                 var dist = A3(Public.Vec2.Vec2.minimumDist,
                                                               bp.start,
                                                               bp.end,
                                                               pointerV);
                                                 return _N.insert("id",bp.id,dist);
                                               }();
                                      });
                   var placeStructure = F3(function (p,best,e)
                                           {
                                             return function ()
                                                    {
                                                      var s = e.cache.structure;
                                                      return _N.cmp(best.id,0) < 0 ? s : function ()
                                                                                         {
                                                                                           var placePart = function (p)
                                                                                                           {
                                                                                                             return Types.part(p);
                                                                                                           };
                                                                                           var placeBeam = F2(function (b,
                                                                                                                        subs)
                                                                                                              {
                                                                                                                return Types.beam(_N.remove("id",
                                                                                                                                            b))(_N.eq(best.id,
                                                                                                                                                      b.id) ? {ctor: "::", _0: {ctor: "_Tuple2", _0: {_: {}, offset: best.offset, theta: 0}, _1: Types.part(p)}, _1: subs} : subs);
                                                                                                              });
                                                                                           return A2(Public.TagTree.TagTree.foldTagTree$,
                                                                                                     placePart,
                                                                                                     placeBeam)(Types.labelBeams(s));
                                                                                         }();
                                                    }();
                                           });
                   var placePhantomPart = F3(function (p,best,e)
                                             {
                                               return function ()
                                                      {
                                                        var s = A3(placeStructure,p,best,e);
                                                        var c = e.cache;
                                                        return _N.replace([["cache",
                                                                            _N.replace([["structure",
                                                                                         s]],
                                                                                       c)]],
                                                                          e);
                                                      }();
                                             });
                   var dimensions = {ctor: "_Tuple2", _0: 800, _1: 600};
                   var compareDists = F2(function (p1,p2)
                                         {
                                           return _N.cmp(p1.r,p2.r) < 0 ? p1 : p2;
                                         });
                   var minPointDist = F2(function (pointerV,bps)
                                         {
                                           return function ()
                                                  {
                                                    var minDist = 50;
                                                    var labeledDists = A2(List.map,
                                                                          pointDist(pointerV),
                                                                          bps);
                                                    var fakePoint = {_: {}, id: 0 - 1, offset: 0, r: minDist};
                                                    return A3(List.foldl,
                                                              compareDists,
                                                              fakePoint,
                                                              labeledDists);
                                                  }();
                                         });
                   var buildPoints = function ()
                                     {
                                       var partPoints = Utils.cnst(_J.toList([]));
                                       var beamPoint = function (beam)
                                                       {
                                                         return {_: {}, end: {_: {}, x: beam.r, y: 0}, id: beam.id, start: Public.Vec2.Vec2.origin};
                                                       };
                                       var beamPoints = F2(function (beam,subs)
                                                           {
                                                             return {ctor: "::", _0: beamPoint(beam), _1: List.concat(subs)};
                                                           });
                                       var attachPoint = F2(function (arg1,bp)
                                                            {
                                                              return function ()
                                                                     {
                                                                       return function ()
                                                                              {
                                                                                var place = function ($)
                                                                                            {
                                                                                              return Public.Vec2.Vec2.addVec({_: {}, x: arg1.offset, y: 0})(Public.Vec2.Vec2.rotVec(arg1.theta)($));
                                                                                            };
                                                                                return _N.replace([["start",
                                                                                                    place(bp.start)],
                                                                                                   ["end",
                                                                                                    place(bp.end)]],
                                                                                                  bp);
                                                                              }();
                                                                     }();
                                                            });
                                       var attachPoints = function (attach)
                                                          {
                                                            return List.map(attachPoint(attach));
                                                          };
                                       return A3(Public.TagTree.TagTree.foldTagTree,
                                                 partPoints,
                                                 beamPoints,
                                                 attachPoints);
                                     }();
                   var bestPlacement = F2(function (absPointerV,entity)
                                          {
                                            return function ()
                                                   {
                                                     var localPointerV = A2(Public.Vec2.Vec2.subVec,
                                                                            entity.motion.pos,
                                                                            absPointerV);
                                                     return minPointDist(localPointerV)(buildPoints(Types.labelBeams(entity.cache.structure)));
                                                   }();
                                          });
                   var addPhantom = function (state)
                                    {
                                      return function ()
                                             {
                                               var buildMode = state.mode.build;
                                               var e = buildMode.entity;
                                               var placement = buildMode.placement;
                                               return function ()
                                                      {
                                                        switch (placement.ctor)
                                                        {case
                                                         "Just" :
                                                           return function ()
                                                                  {
                                                                    var place = A2(placePhantomPart,
                                                                                   buildMode.part,
                                                                                   placement._0);
                                                                    var es = A3(Utils.updateDict,
                                                                                e,
                                                                                place,
                                                                                state.entities);
                                                                    return _N.replace([["entities",
                                                                                        es]],
                                                                                      state);
                                                                  }();
                                                         case
                                                         "Nothing" :
                                                           return state;}
                                                        _E.Case($moduleName,
                                                                "between lines 121 and 126");
                                                      }();
                                             }();
                                    };
                   var BuildPoint = F3(function (a,b,c)
                                       {
                                         return {_: {}, end: c, id: a, start: b};
                                       });
                   elm.ShipWright = {_op: _op, dimensions: dimensions, buildPoints: buildPoints, pointDist: pointDist, compareDists: compareDists, minPointDist: minPointDist, bestPlacement: bestPlacement, placeStructure: placeStructure, placePhantomPart: placePhantomPart, addPhantom: addPhantom, BuildPoint: BuildPoint};
                   return elm.ShipWright;
                 };Elm.Main = function (elm)
           {
             if (elm.Main)
             return elm.Main;
             var N = Elm.Native,
                 _N = N.Utils(elm),
                 _L = N.List(elm),
                 _E = N.Error(elm),
                 _J = N.JavaScript(elm),
                 _str = _J.toString,
                 $moduleName = "Main";
             var Text = Elm.Text(elm);
             var Text = Elm.Text(elm);
             var Basics = Elm.Basics(elm);
             var Signal = Elm.Signal(elm);
             var List = Elm.List(elm);
             var Maybe = Elm.Maybe(elm);
             var Time = Elm.Time(elm);
             var Prelude = Elm.Prelude(elm);
             var Graphics = Graphics || {};
             Graphics.Element = Elm.Graphics.Element(elm);
             var Color = Elm.Color(elm);
             var Graphics = Graphics || {};
             Graphics.Collage = Elm.Graphics.Collage(elm);
             var Char = Elm.Char(elm);
             var Keyboard = Elm.Keyboard(elm);
             var Mouse = Elm.Mouse(elm);
             var Draw = Elm.Draw(elm);
             var Physics = Elm.Physics(elm);
             var Types = Elm.Types(elm);
             var Utils = Elm.Utils(elm);
             var Public = Public || {};
             Public.Vec2 = Public.Vec2 || {};
             Public.Vec2.Vec2 = Elm.Public.Vec2.Vec2(elm);
             var _op = {};
             var startPos = {_: {}, omega: 0, pos: {_: {}, theta: 0, x: 0, y: 0}, v: {_: {}, x: 0, y: 0}};
             var reverseR = Types.beam({_: {}, r: 10})(_J.toList([{ctor: "_Tuple2", _0: {_: {}, offset: 10, theta: Basics.pi / 2}, _1: Types.part(Types.Engine({_: {}, config: Types.Reverse, r: 4}))}]));
             var reverseL = Types.beam({_: {}, r: 10})(_J.toList([{ctor: "_Tuple2", _0: {_: {}, offset: 10, theta: (0 - Basics.pi) / 2}, _1: Types.part(Types.Engine({_: {}, config: Types.Reverse, r: 4}))}]));
             var control = function (input)
                           {
                             return _L.append(_N.cmp(input.y,
                                                     0) < 0 ? _J.toList([Types.Reverse]) : _J.toList([]),
                                              _L.append(_N.cmp(input.y,
                                                               0) > 0 ? _J.toList([Types.Forward]) : _J.toList([]),
                                                        _L.append(_N.cmp(input.x,
                                                                         0) > 0 ? _J.toList([Types.TurnRight]) : _J.toList([]),
                                                                  _N.cmp(input.x,
                                                                         0) < 0 ? _J.toList([Types.TurnLeft]) : _J.toList([]))));
                           };
             var engines = A2(Signal._op["<~"],control,Keyboard.wasd);
             var canvasWH = {ctor: "_Tuple2", _0: 400, _1: 300};
             var gamePointer = A2(Signal._op["<~"],
                                  Utils.convertPos(canvasWH),
                                  Mouse.position);
             var brakes = Keyboard.isDown(Char.toCode("x"));
             var attitude = function (ec)
                            {
                              return Types.beam({_: {}, r: 10})(_J.toList([{ctor: "_Tuple2", _0: {_: {}, offset: 10, theta: 0}, _1: Types.part(Types.Engine({_: {}, config: ec, r: 4}))}]));
                            };
             var mods = _J.toList([{ctor: "_Tuple2", _0: {_: {}, offset: 6, theta: 3 * Basics.pi / 2}, _1: reverseL},
                                   {ctor: "_Tuple2", _0: {_: {}, offset: 6, theta: Basics.pi / 2}, _1: reverseR},
                                   {ctor: "_Tuple2", _0: {_: {}, offset: 42, theta: 3 * Basics.pi / 2}, _1: attitude(Types.TurnLeft)},
                                   {ctor: "_Tuple2", _0: {_: {}, offset: 42, theta: Basics.pi / 2}, _1: attitude(Types.TurnRight)},
                                   {ctor: "_Tuple2", _0: {_: {}, offset: 0, theta: 0}, _1: Types.part(Types.Brain({_: {}, r: 7}))},
                                   {ctor: "_Tuple2", _0: {_: {}, offset: 25, theta: 0}, _1: Types.part(Types.FuelTank({_: {}, l: 30, w: 14}))},
                                   {ctor: "_Tuple2", _0: {_: {}, offset: 50, theta: 0}, _1: Types.part(Types.Engine({_: {}, config: Types.Forward, r: 13}))}]);
             var simpleShip = A2(Types.beam,{_: {}, r: 50},mods);
             elm.Main = {_op: _op, attitude: attitude, reverseL: reverseL, reverseR: reverseR, mods: mods, simpleShip: simpleShip, startPos: startPos, control: control, engines: engines, brakes: brakes, canvasWH: canvasWH, gamePointer: gamePointer};
             return elm.Main;
           };Elm.Draw = function (elm)
           {
             if (elm.Draw)
             return elm.Draw;
             var N = Elm.Native,
                 _N = N.Utils(elm),
                 _L = N.List(elm),
                 _E = N.Error(elm),
                 _J = N.JavaScript(elm),
                 _str = _J.toString,
                 $moduleName = "Draw";
             var Text = Elm.Text(elm);
             var Text = Elm.Text(elm);
             var Basics = Elm.Basics(elm);
             var Signal = Elm.Signal(elm);
             var List = Elm.List(elm);
             var Maybe = Elm.Maybe(elm);
             var Time = Elm.Time(elm);
             var Prelude = Elm.Prelude(elm);
             var Graphics = Graphics || {};
             Graphics.Element = Elm.Graphics.Element(elm);
             var Color = Elm.Color(elm);
             var Graphics = Graphics || {};
             Graphics.Collage = Elm.Graphics.Collage(elm);
             var Either = Elm.Either(elm);
             var Graphics = Graphics || {};
             Graphics.Collage = Elm.Graphics.Collage(elm);
             var Transform2D = Elm.Transform2D(elm);
             var Transform2D = Elm.Transform2D(elm);
             var Physics = Elm.Physics(elm);
             var Public = Public || {};
             Public.TagTree = Public.TagTree || {};
             Public.TagTree.TagTree = Elm.Public.TagTree.TagTree(elm);
             var Types = Elm.Types(elm);
             var Public = Public || {};
             Public.Vec2 = Public.Vec2 || {};
             Public.Vec2.Vec2 = Elm.Public.Vec2.Vec2(elm);
             var _op = {};
             var translation = A4(Transform2D.matrix,1,0,0,1);
             var drawPart = F3(function (noise,ecs,part)
                               {
                                 return function ()
                                        {
                                          var hashedNoise = A2(Basics.mod,
                                                               Basics.truncate(noise),
                                                               150);
                                          var gasColor = A3(Color.rgb,255,255 - hashedNoise,0);
                                          return function ()
                                                 {
                                                   switch (part.ctor)
                                                   {case
                                                    "Brain" :
                                                      return Graphics.Collage.filled(Color.blue)(Graphics.Collage.circle(part._0.r));
                                                    case
                                                    "Engine" :
                                                      return Graphics.Collage.group({ctor: "::", _0: Graphics.Collage.rotate(Basics.pi)(Graphics.Collage.filled(Color.red)(A2(Graphics.Collage.ngon,
                                                                                                                                                                              3,
                                                                                                                                                                              part._0.r))), _1: A2(List.any,
                                                                                                                                                                                                   function (ec)
                                                                                                                                                                                                   {
                                                                                                                                                                                                     return _N.eq(ec,
                                                                                                                                                                                                                  part._0.config);
                                                                                                                                                                                                   },
                                                                                                                                                                                                   ecs) ? _J.toList([Graphics.Collage.move({ctor: "_Tuple2", _0: 0.4 * part._0.r, _1: 0})(Graphics.Collage.rotate(Basics.pi)(Graphics.Collage.filled(gasColor)(A2(Graphics.Collage.ngon,
                                                                                                                                                                                                                                                                                                                                                                  3,
                                                                                                                                                                                                                                                                                                                                                                  part._0.r * 0.8))))]) : _J.toList([])});
                                                    case
                                                    "FuelTank" :
                                                      return Graphics.Collage.filled(Color.green)(A2(Graphics.Collage.rect,
                                                                                                     part._0.l,
                                                                                                     part._0.w));}
                                                   _E.Case($moduleName,"between lines 42 and 52");
                                                 }();
                                        }();
                               });
             var drawBuildArea = function (mode)
                                 {
                                   return function ()
                                          {
                                            var _case4 = mode.placement;
                                            switch (_case4.ctor)
                                            {case
                                             "Nothing" :
                                               return Graphics.Collage.group(_J.toList([]));}
                                            return Graphics.Collage.filled(A4(Color.rgba,
                                                                              255,
                                                                              255,
                                                                              0,
                                                                              0.2))(A2(Graphics.Collage.oval,
                                                                                       200,
                                                                                       200));
                                          }();
                                 };
             var drawBeam = F2(function (beam,subForms)
                               {
                                 return function ()
                                        {
                                          var w = 2;
                                          var l = beam.r;
                                          var beamForm = Graphics.Collage.move({ctor: "_Tuple2", _0: l * 0.5, _1: 0})(Graphics.Collage.filled(Color.white)(A2(Graphics.Collage.rect,
                                                                                                                                                              l,
                                                                                                                                                              w)));
                                          return Graphics.Collage.group({ctor: "::", _0: beamForm, _1: subForms});
                                        }();
                               });
             var drawAttach = F2(function (arg1,subForm)
                                 {
                                   return function ()
                                          {
                                            return function ()
                                                   {
                                                     var modelM = A2(Transform2D.multiply,
                                                                     A2(translation,arg1.offset,0),
                                                                     Transform2D.rotation(arg1.theta));
                                                     return A2(Graphics.Collage.groupTransform,
                                                               modelM,
                                                               _J.toList([subForm]));
                                                   }();
                                          }();
                                 });
             var drawStructure = F3(function (noise,ec,structure)
                                    {
                                      return A4(Public.TagTree.TagTree.foldTagTree,
                                                A2(drawPart,noise,ec),
                                                drawBeam,
                                                drawAttach,
                                                structure);
                                    });
             var drawEntity = F2(function (noise,arg0)
                                 {
                                   return function ()
                                          {
                                            return function ()
                                                   {
                                                     var rotM = Transform2D.rotation(arg0.motion.pos.theta);
                                                     var moveM = A2(translation,
                                                                    arg0.motion.pos.x,
                                                                    arg0.motion.pos.y);
                                                     var modelM = A2(Transform2D.multiply,
                                                                     moveM,
                                                                     rotM);
                                                     var engines = function ()
                                                                   {
                                                                     var _case7 = arg0.controls;
                                                                     switch (_case7.ctor)
                                                                     {case
                                                                      "Left" :
                                                                        return _J.toList([]);
                                                                      case
                                                                      "Right" :
                                                                        return _case7._0;}
                                                                     _E.Case($moduleName,
                                                                             "between lines 75 and 78");
                                                                   }();
                                                     return Graphics.Collage.groupTransform(modelM)(_J.toList([A3(drawStructure,
                                                                                                                  noise,
                                                                                                                  engines,
                                                                                                                  arg0.cache.structure)]));
                                                   }();
                                          }();
                                 });
             elm.Draw = {_op: _op, translation: translation, drawPart: drawPart, drawAttach: drawAttach, drawBeam: drawBeam, drawStructure: drawStructure, drawEntity: drawEntity, drawBuildArea: drawBuildArea};
             return elm.Draw;
           };Elm.GameInputs = function (elm)
                 {
                   if (elm.GameInputs)
                   return elm.GameInputs;
                   var N = Elm.Native,
                       _N = N.Utils(elm),
                       _L = N.List(elm),
                       _E = N.Error(elm),
                       _J = N.JavaScript(elm),
                       _str = _J.toString,
                       $moduleName = "GameInputs";
                   var Text = Elm.Text(elm);
                   var Text = Elm.Text(elm);
                   var Basics = Elm.Basics(elm);
                   var Signal = Elm.Signal(elm);
                   var List = Elm.List(elm);
                   var Maybe = Elm.Maybe(elm);
                   var Time = Elm.Time(elm);
                   var Prelude = Elm.Prelude(elm);
                   var Graphics = Graphics || {};
                   Graphics.Element = Elm.Graphics.Element(elm);
                   var Color = Elm.Color(elm);
                   var Graphics = Graphics || {};
                   Graphics.Collage = Elm.Graphics.Collage(elm);
                   var Either = Elm.Either(elm);
                   var Char = Elm.Char(elm);
                   var Dict = Elm.Dict(elm);
                   var Dict = Elm.Dict(elm);
                   var Keyboard = Elm.Keyboard(elm);
                   var Keyboard = Elm.Keyboard(elm);
                   var Mouse = Elm.Mouse(elm);
                   var Time = Elm.Time(elm);
                   var Window = Elm.Window(elm);
                   var Types = Elm.Types(elm);
                   var Utils = Elm.Utils(elm);
                   var _op = {};
                   var watchKeymap = Dict.fromList(_J.toList([{ctor: "_Tuple2", _0: Char.toCode("1"), _1: Types.Number(1)},
                                                              {ctor: "_Tuple2", _0: Char.toCode("2"), _1: Types.Number(2)},
                                                              {ctor: "_Tuple2", _0: Char.toCode("3"), _1: Types.Number(3)},
                                                              {ctor: "_Tuple2", _0: Char.toCode("4"), _1: Types.Number(4)},
                                                              {ctor: "_Tuple2", _0: Char.toCode("5"), _1: Types.Number(5)},
                                                              {ctor: "_Tuple2", _0: Char.toCode("p"), _1: Types.Pause},
                                                              {ctor: "_Tuple2", _0: Char.toCode("c"), _1: Types.Cycle},
                                                              {ctor: "_Tuple2", _0: 27, _1: Types.Exit}]));
                   var ticks = A2(Signal._op["<~"],Types.FPS,Time.fps(25));
                   var pointer = A2(Signal._op["<~"],
                                    Types.Pointer,
                                    A2(Signal._op["~"],
                                       A2(Signal._op["<~"],Utils.convertPos,Window.dimensions),
                                       Mouse.position));
                   var modeKeysDown = function ()
                                      {
                                        var watchKeys = Dict.toList(watchKeymap);
                                        var keysDown = A2(List.map,
                                                          function (arg0)
                                                          {
                                                            return function ()
                                                                   {
                                                                     switch (arg0.ctor)
                                                                     {case
                                                                      "_Tuple2" :
                                                                        return Signal.lift(Utils.cnst(arg0._1))(A2(Signal.keepIf,
                                                                                                                   Basics.id,
                                                                                                                   true)(Keyboard.isDown(arg0._0)));}
                                                                     _E.Case($moduleName,
                                                                             "on line 73, column 38 to 87");
                                                                   }();
                                                          },
                                                          watchKeys);
                                        return Signal.merges(keysDown);
                                      }();
                   var modes = A2(Signal._op["<~"],Types.Modal,modeKeysDown);
                   var engines = function ()
                                 {
                                   var override = F2(function (b,ecs)
                                                     {
                                                       return b ? Either.Left(Types.Brakes) : Either.Right(ecs);
                                                     });
                                   var controls = A2(Signal._op["<~"],
                                                     Utils.controlEngines,
                                                     Keyboard.wasd);
                                   var brakes = Keyboard.isDown(Char.toCode("x"));
                                   return A2(Signal._op["~"],
                                             A2(Signal._op["<~"],override,brakes),
                                             controls);
                                 }();
                   var clicks = A2(Signal._op["<~"],
                                   Utils.cnst(Types.Click),
                                   Mouse.clicks);
                   var triggers = Signal.merges(_J.toList([clicks,
                                                           modes,
                                                           ticks,
                                                           pointer]));
                   var gameInputs = Signal.sampleOn(triggers)(A2(Signal._op["~"],
                                                                 A2(Signal._op["~"],
                                                                    A2(Signal._op["<~"],
                                                                       F3(function (engines,
                                                                                    window,
                                                                                    trigger)
                                                                          {
                                                                            return {_: {}, engines: engines, trigger: trigger, window: window};
                                                                          }),
                                                                       engines),
                                                                    Window.dimensions),
                                                                 triggers));
                   elm.GameInputs = {_op: _op, gameInputs: gameInputs, engines: engines, triggers: triggers, clicks: clicks, watchKeymap: watchKeymap, modeKeysDown: modeKeysDown, modes: modes, ticks: ticks, pointer: pointer};
                   return elm.GameInputs;
                 };Elm.Physics = function (elm)
              {
                if (elm.Physics)
                return elm.Physics;
                var N = Elm.Native,
                    _N = N.Utils(elm),
                    _L = N.List(elm),
                    _E = N.Error(elm),
                    _J = N.JavaScript(elm),
                    _str = _J.toString,
                    $moduleName = "Physics";
                var Text = Elm.Text(elm);
                var Text = Elm.Text(elm);
                var Basics = Elm.Basics(elm);
                var Signal = Elm.Signal(elm);
                var List = Elm.List(elm);
                var Maybe = Elm.Maybe(elm);
                var Time = Elm.Time(elm);
                var Prelude = Elm.Prelude(elm);
                var Graphics = Graphics || {};
                Graphics.Element = Elm.Graphics.Element(elm);
                var Color = Elm.Color(elm);
                var Graphics = Graphics || {};
                Graphics.Collage = Elm.Graphics.Collage(elm);
                var Public = Public || {};
                Public.Vec2 = Public.Vec2 || {};
                Public.Vec2.Vec2 = Elm.Public.Vec2.Vec2(elm);
                var Public = Public || {};
                Public.TagTree = Public.TagTree || {};
                Public.TagTree.TagTree = Elm.Public.TagTree.TagTree(elm);
                var Types = Elm.Types(elm);
                var Utils = Elm.Utils(elm);
                var _op = {};
                var updateMotion = F3(function (cache,delta,state)
                                      {
                                        return function ()
                                               {
                                                 var oldTheta = state.pos.theta;
                                                 var oldRootPos = state.pos;
                                                 var oldComOffset = A2(Public.Vec2.Vec2.rotVec,
                                                                       oldTheta,
                                                                       cache.comOffset);
                                                 var oldComPos = A2(Public.Vec2.Vec2.addVec,
                                                                    oldComOffset,
                                                                    oldRootPos);
                                                 var newOmega = delta.alpha + state.omega;
                                                 var midOmega = (state.omega + newOmega) / 2;
                                                 var newTheta = oldTheta + midOmega;
                                                 var newComOffset = A2(Public.Vec2.Vec2.rotVec,
                                                                       newTheta,
                                                                       cache.comOffset);
                                                 var absA = A2(Public.Vec2.Vec2.rotVec,
                                                               oldTheta,
                                                               delta.a);
                                                 var newV = A2(Public.Vec2.Vec2.addVec,
                                                               absA,
                                                               state.v);
                                                 var midV = A2(Public.Vec2.Vec2.midVec,
                                                               state.v,
                                                               newV);
                                                 var newComPos = Public.Vec2.Vec2.addVec(midV)(_N.replace([["theta",
                                                                                                            newTheta]],
                                                                                                          oldComPos));
                                                 var newRootPos = A2(Public.Vec2.Vec2.subVec,
                                                                     newComOffset,
                                                                     newComPos);
                                                 return _N.replace([["pos",newRootPos],
                                                                    ["v",newV],
                                                                    ["omega",newOmega]],
                                                                   state);
                                               }();
                                      });
                var updateBrakes = F2(function (cache,state)
                                      {
                                        return function ()
                                               {
                                                 var brakeVelY = A3(Basics.clamp,
                                                                    0 - 0.1,
                                                                    0.1,
                                                                    state.v.y);
                                                 var brakeVelX = A3(Basics.clamp,
                                                                    0 - 0.1,
                                                                    0.1,
                                                                    state.v.x);
                                                 var brakeTheta = A3(Basics.clamp,
                                                                     0 - 1.0e-3,
                                                                     1.0e-3,
                                                                     state.omega);
                                                 var fakeDelta = {_: {}, a: A2(Public.Vec2.Vec2.rotVec,
                                                                               0 - state.pos.theta,
                                                                               {_: {}, x: 0 - brakeVelX, y: 0 - brakeVelY}), alpha: 0 - brakeTheta};
                                                 return A3(updateMotion,cache,fakeDelta,state);
                                               }();
                                      });
                var translateMoment = F2(function (a,m)
                                         {
                                           return function ()
                                                  {
                                                    switch (m.ctor)
                                                    {case
                                                     "ParallelAxis" :
                                                       return Types.ParallelAxis(A2(Types.translateAttach,
                                                                                    a,
                                                                                    m._0));
                                                     case
                                                     "Point" :
                                                       return Types.Point(A2(Types.translateAttach,
                                                                             a,
                                                                             m._0));}
                                                    _E.Case($moduleName,"between lines 85 and 87");
                                                  }();
                                         });
                var torqueMag = function (t)
                                {
                                  return A2(Public.Vec2.Vec2.crossVecMag,t.disp,t.force);
                                };
                var sumMasses = function ($)
                                {
                                  return List.sum(List.map(function (pm)
                                                           {
                                                             return pm.m;
                                                           })($));
                                };
                var rotInertiaContrib = function (pm)
                                        {
                                          return function ()
                                                 {
                                                   var r = Public.Vec2.Vec2.magnitude(pm);
                                                   return pm.m * r * r;
                                                 }();
                                        };
                var partThrusts = F2(function (ecs,part)
                                     {
                                       return function ()
                                              {
                                                switch (part.ctor)
                                                {case
                                                 "Engine" :
                                                   return A2(List.any,
                                                             function (ec)
                                                             {
                                                               return _N.eq(ec,part._0.config);
                                                             },
                                                             ecs) ? function ()
                                                                    {
                                                                      var force = (0 - 8) * part._0.r;
                                                                      return _J.toList([{_: {}, disp: Public.Vec2.Vec2.origin, force: {_: {}, x: force, y: 0}}]);
                                                                    }() : _J.toList([]);}
                                                return _J.toList([]);
                                              }();
                                     });
                var partMasses = function (part)
                                 {
                                   return function ()
                                          {
                                            var m = function ()
                                                    {
                                                      switch (part.ctor)
                                                      {case
                                                       "Brain" :
                                                         return 3 * part._0.r * part._0.r;
                                                       case
                                                       "Engine" :
                                                         return 2 * part._0.r * part._0.r;
                                                       case
                                                       "FuelTank" :
                                                         return 1.5 * part._0.l * part._0.w;}
                                                      _E.Case($moduleName,
                                                              "between lines 38 and 42");
                                                    }();
                                            return _J.toList([{_: {}, m: m, x: 0, y: 0}]);
                                          }();
                                 };
                var partMoment = function ($)
                                 {
                                   return List.map(Types.Point)(partMasses($));
                                 };
                var momentMapVec = F2(function (f,m)
                                      {
                                        return function ()
                                               {
                                                 switch (m.ctor)
                                                 {case
                                                  "ParallelAxis" :
                                                    return function ()
                                                           {
                                                             var pav = Public.Vec2.Vec2.extractVec(m._0);
                                                             var paf = f(pav);
                                                             return Types.ParallelAxis(_N.replace([["x",
                                                                                                    paf.x],
                                                                                                   ["y",
                                                                                                    paf.y]],
                                                                                                  m._0));
                                                           }();
                                                  case
                                                  "Point" :
                                                    return function ()
                                                           {
                                                             var pmv = Public.Vec2.Vec2.extractVec(m._0);
                                                             var pmf = f(pmv);
                                                             return Types.Point(_N.replace([["x",
                                                                                             pmf.x],
                                                                                            ["y",
                                                                                             pmf.y]],
                                                                                           m._0));
                                                           }();}
                                                 _E.Case($moduleName,"between lines 74 and 82");
                                               }();
                                      });
                var momentContrib = function (m)
                                    {
                                      return function ()
                                             {
                                               switch (m.ctor)
                                               {case
                                                "ParallelAxis" :
                                                  return function ()
                                                         {
                                                           var r = Public.Vec2.Vec2.magnitude(m._0);
                                                           return m._0.m * r * r + m._0.localMoment;
                                                         }();
                                                case
                                                "Point" :
                                                  return function ()
                                                         {
                                                           var r = Public.Vec2.Vec2.magnitude(m._0);
                                                           return m._0.m * r * r;
                                                         }();}
                                               _E.Case($moduleName,"between lines 96 and 102");
                                             }();
                                    };
                var massContrib = function (pm)
                                  {
                                    return Public.Vec2.Vec2.scaleVec(pm.m)(Public.Vec2.Vec2.extractVec(pm));
                                  };
                var beamThrusts = Utils.cnst(List.concat);
                var beamMoment = F2(function (beam,subs)
                                    {
                                      return function ()
                                             {
                                               var m = 0.1 * beam.r;
                                               var parallel = {_: {}, localMoment: 1 / 12 * m * beam.r * beam.r, m: m, x: beam.r / 2, y: 0};
                                               return {ctor: "::", _0: Types.ParallelAxis(parallel), _1: List.concat(subs)};
                                             }();
                                    });
                var beamMasses = F2(function (beam,subs)
                                    {
                                      return {ctor: "::", _0: {_: {}, m: 0.1 * beam.r, x: beam.r / 2, y: 0}, _1: List.concat(subs)};
                                    });
                var attachThrusts = F2(function (attach,ts)
                                       {
                                         return function ()
                                                {
                                                  var rotateForce = function (t)
                                                                    {
                                                                      return _N.replace([["force",
                                                                                          A2(Public.Vec2.Vec2.rotVec,
                                                                                             attach.theta,
                                                                                             t.force)]],
                                                                                        t);
                                                                    };
                                                  var rotateDisp = function (t)
                                                                   {
                                                                     return _N.replace([["disp",
                                                                                         A2(Public.Vec2.Vec2.rotVec,
                                                                                            attach.theta,
                                                                                            t.disp)]],
                                                                                       t);
                                                                   };
                                                  var offsetDisp = function (t)
                                                                   {
                                                                     return _N.replace([["disp",
                                                                                         A2(Public.Vec2.Vec2.addVec,
                                                                                            {_: {}, x: attach.offset, y: 0},
                                                                                            t.disp)]],
                                                                                       t);
                                                                   };
                                                  return List.map(function ($)
                                                                  {
                                                                    return offsetDisp(rotateDisp(rotateForce($)));
                                                                  })(ts);
                                                }();
                                       });
                var structureThrusts = function (ec)
                                       {
                                         return A3(Public.TagTree.TagTree.foldTagTree,
                                                   partThrusts(ec),
                                                   beamThrusts,
                                                   attachThrusts);
                                       };
                var netForce = F2(function (controls,cache)
                                  {
                                    return Public.Vec2.Vec2.sumVec(List.map(function (_)
                                                                            {
                                                                              return _.force;
                                                                            })(A2(structureThrusts,
                                                                                  controls,
                                                                                  cache.structure)));
                                  });
                var netAcceleration = F2(function (controls,cache)
                                         {
                                           return Public.Vec2.Vec2.scaleVec(1 / cache.totalMass)(A2(netForce,
                                                                                                    controls,
                                                                                                    cache));
                                         });
                var netTorque = F2(function (controls,cache)
                                   {
                                     return function ()
                                            {
                                              var thrusts = A2(structureThrusts,
                                                               controls,
                                                               cache.structure);
                                              var com = cache.comOffset;
                                              var center = function (thrust)
                                                           {
                                                             return _N.replace([["disp",
                                                                                 A2(Public.Vec2.Vec2.subVec,
                                                                                    com,
                                                                                    thrust.disp)]],
                                                                               thrust);
                                                           };
                                              var torqueForces = A2(List.map,center,thrusts);
                                              return List.sum(List.map(torqueMag)(torqueForces));
                                            }();
                                   });
                var netRotAcceleration = F2(function (controls,cache)
                                            {
                                              return A2(netTorque,
                                                        controls,
                                                        cache) / cache.rotInertia;
                                            });
                var netDelta = F2(function (controls,cache)
                                  {
                                    return A2(Types.MotionDelta,
                                              A2(netAcceleration,controls,cache),
                                              A2(netRotAcceleration,controls,cache));
                                  });
                var attachMoment = function (attach)
                                   {
                                     return List.map(translateMoment(attach));
                                   };
                var structureMoments = A3(Public.TagTree.TagTree.foldTagTree,
                                          partMoment,
                                          beamMoment,
                                          attachMoment);
                var attachMasses = function (attach)
                                   {
                                     return List.map(Types.translateAttach(attach));
                                   };
                var structureMasses = A3(Public.TagTree.TagTree.foldTagTree,
                                         partMasses,
                                         beamMasses,
                                         attachMasses);
                var totalMass = function ($)
                                {
                                  return sumMasses(structureMasses($));
                                };
                var centerOfMass = function (structure)
                                   {
                                     return Public.Vec2.Vec2.scaleVec(1 / totalMass(structure))(Public.Vec2.Vec2.sumVec(List.map(massContrib)(structureMasses(structure))));
                                   };
                var rotInertia = function (structure)
                                 {
                                   return List.sum(List.map(momentContrib)(List.map(momentMapVec(Public.Vec2.Vec2.subVec(centerOfMass(structure))))(structureMoments(structure))));
                                 };
                var genEntityCache = function (s)
                                     {
                                       return A4(Types.EntityCache,
                                                 s,
                                                 centerOfMass(s),
                                                 totalMass(s),
                                                 rotInertia(s));
                                     };
                var applyBrakes = function (state)
                                  {
                                    return function ()
                                           {
                                             var w = state.omega;
                                             var vy = state.v.y;
                                             var vx = state.v.x;
                                             var rotfactor = 5.0e-4;
                                             var posfactor = 1.0e-2;
                                             var damp = F2(function (factor,n)
                                                           {
                                                             return _N.cmp(n,
                                                                           factor) < 0 && _N.cmp(n,
                                                                                                 (0 - 1) * factor) > 0 ? 0 : _N.cmp(n,
                                                                                                                                    0) > 0 ? n - factor : n + factor;
                                                           });
                                             return {_: {}, newOmega: A2(damp,
                                                                         rotfactor,
                                                                         w), newV: {_: {}, x: A2(damp,
                                                                                                 posfactor,
                                                                                                 vx), y: A2(damp,
                                                                                                            posfactor,
                                                                                                            vy)}};
                                           }();
                                  };
                elm.Physics = {_op: _op, sumMasses: sumMasses, massContrib: massContrib, partMasses: partMasses, beamMasses: beamMasses, attachMasses: attachMasses, structureMasses: structureMasses, totalMass: totalMass, centerOfMass: centerOfMass, partMoment: partMoment, beamMoment: beamMoment, momentMapVec: momentMapVec, translateMoment: translateMoment, attachMoment: attachMoment, structureMoments: structureMoments, momentContrib: momentContrib, rotInertiaContrib: rotInertiaContrib, rotInertia: rotInertia, genEntityCache: genEntityCache, partThrusts: partThrusts, beamThrusts: beamThrusts, attachThrusts: attachThrusts, structureThrusts: structureThrusts, netForce: netForce, netAcceleration: netAcceleration, torqueMag: torqueMag, netTorque: netTorque, netRotAcceleration: netRotAcceleration, netDelta: netDelta, applyBrakes: applyBrakes, updateBrakes: updateBrakes, updateMotion: updateMotion};
                return elm.Physics;
              };Elm.Utils = function (elm)
            {
              if (elm.Utils)
              return elm.Utils;
              var N = Elm.Native,
                  _N = N.Utils(elm),
                  _L = N.List(elm),
                  _E = N.Error(elm),
                  _J = N.JavaScript(elm),
                  _str = _J.toString,
                  $moduleName = "Utils";
              var Text = Elm.Text(elm);
              var Text = Elm.Text(elm);
              var Basics = Elm.Basics(elm);
              var Signal = Elm.Signal(elm);
              var List = Elm.List(elm);
              var Maybe = Elm.Maybe(elm);
              var Time = Elm.Time(elm);
              var Prelude = Elm.Prelude(elm);
              var Graphics = Graphics || {};
              Graphics.Element = Elm.Graphics.Element(elm);
              var Color = Elm.Color(elm);
              var Graphics = Graphics || {};
              Graphics.Collage = Elm.Graphics.Collage(elm);
              var Dict = Elm.Dict(elm);
              var Public = Public || {};
              Public.Vec2 = Public.Vec2 || {};
              Public.Vec2.Vec2 = Elm.Public.Vec2.Vec2(elm);
              var Types = Elm.Types(elm);
              var _op = {};
              var updateDict = F3(function (k,f,d)
                                  {
                                    return function ()
                                           {
                                             var _case0 = A2(Dict.lookup,k,d);
                                             switch (_case0.ctor)
                                             {case
                                              "Just" :
                                                return A3(Dict.insert,k,f(_case0._0),d);
                                              case
                                              "Nothing" :
                                                return d;}
                                             _E.Case($moduleName,"between lines 52 and 54");
                                           }();
                                  });
              var spaceBlack = F2(function (arg1,stuff)
                                  {
                                    return function ()
                                           {
                                             switch (arg1.ctor)
                                             {case
                                              "_Tuple2" :
                                                return A2(Graphics.Collage.collage,
                                                          arg1._0,
                                                          arg1._1)({ctor: "::", _0: Graphics.Collage.filled(Color.black)(A2(Graphics.Collage.rect,
                                                                                                                            Basics.toFloat(arg1._0),
                                                                                                                            Basics.toFloat(arg1._1))), _1: stuff});}
                                             _E.Case($moduleName,"between lines 39 and 41");
                                           }();
                                  });
              var genGameStateCache = F2(function (focus,entities)
                                         {
                                           return function ()
                                                  {
                                                    var camera = function ()
                                                                 {
                                                                   var _case5 = A2(Dict.lookup,
                                                                                   focus,
                                                                                   entities);
                                                                   switch (_case5.ctor)
                                                                   {case
                                                                    "Just" :
                                                                      return function ()
                                                                             {
                                                                               var pos = _case5._0.motion.pos;
                                                                               var rootPos = Public.Vec2.Vec2.extractVec(pos);
                                                                               var comOffset = A2(Public.Vec2.Vec2.rotVec,
                                                                                                  pos.theta,
                                                                                                  _case5._0.cache.comOffset);
                                                                               return A2(Public.Vec2.Vec2.addVec,
                                                                                         comOffset,
                                                                                         rootPos);
                                                                             }();
                                                                    case
                                                                    "Nothing" :
                                                                      return Public.Vec2.Vec2.origin;}
                                                                   _E.Case($moduleName,
                                                                           "between lines 58 and 65");
                                                                 }();
                                                    return Types.GameStateCache(camera);
                                                  }();
                                         });
              var convertPos = F2(function (arg1,arg0)
                                  {
                                    return function ()
                                           {
                                             switch (arg0.ctor)
                                             {case
                                              "_Tuple2" :
                                                return function ()
                                                       {
                                                         switch (arg1.ctor)
                                                         {case
                                                          "_Tuple2" :
                                                            return {ctor: "_Tuple2", _0: arg0._0 - A2(Basics.div,
                                                                                                      arg1._0,
                                                                                                      2), _1: A2(Basics.div,
                                                                                                                 arg1._1,
                                                                                                                 2) - arg0._1};}
                                                         _E.Case($moduleName,
                                                                 "on line 33, column 27 to 51");
                                                       }();}
                                             _E.Case($moduleName,"on line 33, column 27 to 51");
                                           }();
                                  });
              var controlEngines = function (input)
                                   {
                                     return _L.append(_N.cmp(input.y,
                                                             0) < 0 ? _J.toList([Types.Reverse]) : _J.toList([]),
                                                      _L.append(_N.cmp(input.y,
                                                                       0) > 0 ? _J.toList([Types.Forward]) : _J.toList([]),
                                                                _L.append(_N.cmp(input.x,
                                                                                 0) > 0 ? _J.toList([Types.TurnRight]) : _J.toList([]),
                                                                          _N.cmp(input.x,
                                                                                 0) < 0 ? _J.toList([Types.TurnLeft]) : _J.toList([]))));
                                   };
              var combineSElems = F2(function (dir,ses)
                                     {
                                       return A2(Signal._op["<~"],
                                                 Graphics.Element.flow(dir),
                                                 Signal.combine(ses));
                                     });
              var cnst = F2(function (x,a)
                            {
                              return x;
                            });
              elm.Utils = {_op: _op, cnst: cnst, convertPos: convertPos, combineSElems: combineSElems, spaceBlack: spaceBlack, controlEngines: controlEngines, updateDict: updateDict, genGameStateCache: genGameStateCache};
              return elm.Utils;
            };Elm.Types = function (elm)
            {
              if (elm.Types)
              return elm.Types;
              var N = Elm.Native,
                  _N = N.Utils(elm),
                  _L = N.List(elm),
                  _E = N.Error(elm),
                  _J = N.JavaScript(elm),
                  _str = _J.toString,
                  $moduleName = "Types";
              var Text = Elm.Text(elm);
              var Text = Elm.Text(elm);
              var Basics = Elm.Basics(elm);
              var Signal = Elm.Signal(elm);
              var List = Elm.List(elm);
              var Maybe = Elm.Maybe(elm);
              var Time = Elm.Time(elm);
              var Prelude = Elm.Prelude(elm);
              var Graphics = Graphics || {};
              Graphics.Element = Elm.Graphics.Element(elm);
              var Color = Elm.Color(elm);
              var Graphics = Graphics || {};
              Graphics.Collage = Elm.Graphics.Collage(elm);
              var Dict = Elm.Dict(elm);
              var Either = Elm.Either(elm);
              var Public = Public || {};
              Public.State = Public.State || {};
              Public.State.State = Elm.Public.State.State(elm);
              var Public = Public || {};
              Public.TagTree = Public.TagTree || {};
              Public.TagTree.TagTree = Elm.Public.TagTree.TagTree(elm);
              var Public = Public || {};
              Public.Vec2 = Public.Vec2 || {};
              Public.Vec2.Vec2 = Elm.Public.Vec2.Vec2(elm);
              var _op = {};
              var translateAttach = F2(function (attach,vext)
                                       {
                                         return function ()
                                                {
                                                  var dY = attach.offset * Basics.sin(attach.theta);
                                                  var dX = attach.offset * Basics.cos(attach.theta);
                                                  return A2(Public.Vec2.Vec2.addVec,
                                                            {_: {}, x: dX, y: dY},
                                                            vext);
                                                }();
                                       });
              var part = Public.TagTree.TagTree.Leaf;
              var fresh = A2(Public.State.State.bindS,
                             Public.State.State.get,
                             function (i)
                             {
                               return A2(Public.State.State.bindS,
                                         Public.State.State.put(i + 1),
                                         function (arg0)
                                         {
                                           return function ()
                                                  {
                                                    return Public.State.State.returnS(i);
                                                  }();
                                         });
                             });
              var labelBeams = function (s)
                               {
                                 return function ()
                                        {
                                          var labelBeam = function (beam)
                                                          {
                                                            return A2(Public.State.State.fmapS,
                                                                      function (i)
                                                                      {
                                                                        return _N.insert("id",
                                                                                         i,
                                                                                         beam);
                                                                      },
                                                                      fresh);
                                                          };
                                          var modifyStructure = A3(Public.TagTree.TagTree.walkModify,
                                                                   Public.State.State.returnS,
                                                                   labelBeam,
                                                                   Public.State.State.returnS);
                                          return A2(Public.State.State.evalState,
                                                    modifyStructure(s),
                                                    0);
                                        }();
                               };
              var beam = Public.TagTree.TagTree.Node;
              var TurnRight = {ctor: "TurnRight"};
              var TurnLeft = {ctor: "TurnLeft"};
              var Thrust = F2(function (a,b)
                              {
                                return {_: {}, disp: a, force: b};
                              });
              var Reverse = {ctor: "Reverse"};
              var Pointer = function (a)
                            {
                              return {ctor: "Pointer", _0: a};
                            };
              var Point = function (a)
                          {
                            return {ctor: "Point", _0: a};
                          };
              var Pause = {ctor: "Pause"};
              var ParallelAxis = function (a)
                                 {
                                   return {ctor: "ParallelAxis", _0: a};
                                 };
              var Number = function (a)
                           {
                             return {ctor: "Number", _0: a};
                           };
              var MotionState = F3(function (a,b,c)
                                   {
                                     return {_: {}, omega: c, pos: a, v: b};
                                   });
              var MotionDelta = F2(function (a,b)
                                   {
                                     return {_: {}, a: a, alpha: b};
                                   });
              var Mode = F2(function (a,b)
                            {
                              return {_: {}, build: b, pause: a};
                            });
              var Modal = function (a)
                          {
                            return {ctor: "Modal", _0: a};
                          };
              var LabelDist = F3(function (a,b,c)
                                 {
                                   return {_: {}, id: a, offset: c, r: b};
                                 });
              var LabelBeamExt = F2(function (a,b)
                                    {
                                      return _N.insert("id",a,b);
                                    });
              var GameStateCache = function (a)
                                   {
                                     return {_: {}, camera: a};
                                   };
              var GameState = F4(function (a,b,c,d)
                                 {
                                   return {_: {}, cache: d, entities: a, focus: c, mode: b};
                                 });
              var GameInput = F3(function (a,b,c)
                                 {
                                   return {_: {}, engines: a, trigger: c, window: b};
                                 });
              var FuelTank = function (a)
                             {
                               return {ctor: "FuelTank", _0: a};
                             };
              var Forward = {ctor: "Forward"};
              var FPS = function (a)
                        {
                          return {ctor: "FPS", _0: a};
                        };
              var Exit = {ctor: "Exit"};
              var EntityCache = F4(function (a,b,c,d)
                                   {
                                     return {_: {}, comOffset: b, rotInertia: d, structure: a, totalMass: c};
                                   });
              var Entity = F3(function (a,b,c)
                              {
                                return {_: {}, cache: c, controls: a, motion: b};
                              });
              var Engine = function (a)
                           {
                             return {ctor: "Engine", _0: a};
                           };
              var Disabled = {ctor: "Disabled"};
              var Cycle = {ctor: "Cycle"};
              var Click = {ctor: "Click"};
              var BuildMode = F3(function (a,b,c)
                                 {
                                   return {_: {}, entity: a, part: c, placement: b};
                                 });
              var Brakes = {ctor: "Brakes"};
              var Brain = function (a)
                          {
                            return {ctor: "Brain", _0: a};
                          };
              var Beam = function (a)
                         {
                           return {_: {}, r: a};
                         };
              var Attach = F2(function (a,b)
                              {
                                return {_: {}, offset: a, theta: b};
                              });
              elm.Types = {_op: _op, translateAttach: translateAttach, beam: beam, part: part, fresh: fresh, labelBeams: labelBeams, Disabled: Disabled, Forward: Forward, Reverse: Reverse, TurnLeft: TurnLeft, TurnRight: TurnRight, Brain: Brain, FuelTank: FuelTank, Engine: Engine, Point: Point, ParallelAxis: ParallelAxis, Brakes: Brakes, Click: Click, Modal: Modal, FPS: FPS, Pointer: Pointer, Pause: Pause, Cycle: Cycle, Exit: Exit, Number: Number, Attach: Attach, Beam: Beam, LabelBeamExt: LabelBeamExt, Thrust: Thrust, MotionState: MotionState, MotionDelta: MotionDelta, Entity: Entity, EntityCache: EntityCache, GameInput: GameInput, GameState: GameState, GameStateCache: GameStateCache, Mode: Mode, LabelDist: LabelDist, BuildMode: BuildMode};
              return elm.Types;
            };Elm.Public = Elm.Public || {};
Elm.Public.TagTree = Elm.Public.TagTree || {};
Elm.Public.TagTree.TagTree = function (elm)
                             {
                               elm.Public = elm.Public || {};
                               elm.Public.TagTree = elm.Public.TagTree || {};
                               if (elm.Public.TagTree.TagTree)
                               return elm.Public.TagTree.TagTree;
                               var N = Elm.Native,
                                   _N = N.Utils(elm),
                                   _L = N.List(elm),
                                   _E = N.Error(elm),
                                   _J = N.JavaScript(elm),
                                   _str = _J.toString,
                                   $moduleName = "Public.TagTree.TagTree";
                               var Text = Elm.Text(elm);
                               var Text = Elm.Text(elm);
                               var Basics = Elm.Basics(elm);
                               var Signal = Elm.Signal(elm);
                               var List = Elm.List(elm);
                               var Maybe = Elm.Maybe(elm);
                               var Time = Elm.Time(elm);
                               var Prelude = Elm.Prelude(elm);
                               var Graphics = Graphics || {};
                               Graphics.Element = Elm.Graphics.Element(elm);
                               var Color = Elm.Color(elm);
                               var Graphics = Graphics || {};
                               Graphics.Collage = Elm.Graphics.Collage(elm);
                               var Public = Public || {};
                               Public.State = Public.State || {};
                               Public.State.State = Elm.Public.State.State(elm);
                               var _op = {};
                               var Node = F2(function (a,b)
                                             {
                                               return {ctor: "Node", _0: a, _1: b};
                                             });
                               var Leaf = function (a)
                                          {
                                            return {ctor: "Leaf", _0: a};
                                          };
                               var foldTagTree = F4(function (fLeaf,fNode,fEdge,tree)
                                                    {
                                                      return function ()
                                                             {
                                                               var y = A3(foldTagTree,
                                                                          fLeaf,
                                                                          fNode,
                                                                          fEdge);
                                                               var fChild = function (arg0)
                                                                            {
                                                                              return function ()
                                                                                     {
                                                                                       switch (arg0.ctor)
                                                                                       {case
                                                                                        "_Tuple2" :
                                                                                          return fEdge(arg0._0)(y(arg0._1));}
                                                                                       _E.Case($moduleName,
                                                                                               "on line 32, column 30 to 51");
                                                                                     }();
                                                                            };
                                                               return function ()
                                                                      {
                                                                        switch (tree.ctor)
                                                                        {case
                                                                         "Leaf" :
                                                                           return fLeaf(tree._0);
                                                                         case
                                                                         "Node" :
                                                                           return fNode(tree._0)(A2(List.map,
                                                                                                    fChild,
                                                                                                    tree._1));}
                                                                        _E.Case($moduleName,
                                                                                "between lines 33 and 35");
                                                                      }();
                                                             }();
                                                    });
                               var foldTagTree$ = F3(function (fLeaf,fNode,tree)
                                                     {
                                                       return function ()
                                                              {
                                                                var y = A2(foldTagTree$,
                                                                           fLeaf,
                                                                           fNode);
                                                                return function ()
                                                                       {
                                                                         switch (tree.ctor)
                                                                         {case
                                                                          "Leaf" :
                                                                            return fLeaf(tree._0);
                                                                          case
                                                                          "Node" :
                                                                            return function ()
                                                                                   {
                                                                                     var mapAttach = F2(function (f,
                                                                                                                  arg0)
                                                                                                        {
                                                                                                          return function ()
                                                                                                                 {
                                                                                                                   switch (arg0.ctor)
                                                                                                                   {case
                                                                                                                    "_Tuple2" :
                                                                                                                      return {ctor: "_Tuple2", _0: arg0._0, _1: f(arg0._1)};}
                                                                                                                   _E.Case($moduleName,
                                                                                                                           "on line 46, column 38 to 49");
                                                                                                                 }();
                                                                                                        });
                                                                                     var subs$ = A2(List.map,
                                                                                                    mapAttach(y),
                                                                                                    tree._1);
                                                                                     return A2(fNode,
                                                                                               tree._0,
                                                                                               subs$);
                                                                                   }();}
                                                                         _E.Case($moduleName,
                                                                                 "between lines 43 and 48");
                                                                       }();
                                                              }();
                                                     });
                               var walkModify = F4(function (uLeaf,uNode,uEdge,tree)
                                                   {
                                                     return function ()
                                                            {
                                                              var y = A3(walkModify,
                                                                         uLeaf,
                                                                         uNode,
                                                                         uEdge);
                                                              var uSub = function (arg0)
                                                                         {
                                                                           return function ()
                                                                                  {
                                                                                    switch (arg0.ctor)
                                                                                    {case
                                                                                     "_Tuple2" :
                                                                                       return A2(Public.State.State.bindS,
                                                                                                 uEdge(arg0._0),
                                                                                                 function (edge$)
                                                                                                 {
                                                                                                   return A2(Public.State.State.bindS,
                                                                                                             y(arg0._1),
                                                                                                             function (sub$)
                                                                                                             {
                                                                                                               return Public.State.State.returnS({ctor: "_Tuple2", _0: edge$, _1: sub$});
                                                                                                             });
                                                                                                 });}
                                                                                    _E.Case($moduleName,
                                                                                            "between lines 59 and 61");
                                                                                  }();
                                                                         };
                                                              return function ()
                                                                     {
                                                                       switch (tree.ctor)
                                                                       {case
                                                                        "Leaf" :
                                                                          return Public.State.State.fmapS(Leaf)(uLeaf(tree._0));
                                                                        case
                                                                        "Node" :
                                                                          return A2(Public.State.State.bindS,
                                                                                    A2(Public.State.State.mapMS,
                                                                                       uSub,
                                                                                       tree._1),
                                                                                    function (subs$)
                                                                                    {
                                                                                      return A2(Public.State.State.bindS,
                                                                                                uNode(tree._0),
                                                                                                function (node$)
                                                                                                {
                                                                                                  return Public.State.State.returnS(A2(Node,
                                                                                                                                       node$,
                                                                                                                                       subs$));
                                                                                                });
                                                                                    });}
                                                                       _E.Case($moduleName,
                                                                               "between lines 62 and 67");
                                                                     }();
                                                            }();
                                                   });
                               elm.Public.TagTree.TagTree = {_op: _op, foldTagTree: foldTagTree, foldTagTree$: foldTagTree$, walkModify: walkModify, Leaf: Leaf, Node: Node};
                               return elm.Public.TagTree.TagTree;
                             };Elm.Public = Elm.Public || {};
Elm.Public.State = Elm.Public.State || {};
Elm.Public.State.State = function (elm)
                         {
                           elm.Public = elm.Public || {};
                           elm.Public.State = elm.Public.State || {};
                           if (elm.Public.State.State)
                           return elm.Public.State.State;
                           var N = Elm.Native,
                               _N = N.Utils(elm),
                               _L = N.List(elm),
                               _E = N.Error(elm),
                               _J = N.JavaScript(elm),
                               _str = _J.toString,
                               $moduleName = "Public.State.State";
                           var Text = Elm.Text(elm);
                           var Text = Elm.Text(elm);
                           var Basics = Elm.Basics(elm);
                           var Signal = Elm.Signal(elm);
                           var List = Elm.List(elm);
                           var Maybe = Elm.Maybe(elm);
                           var Time = Elm.Time(elm);
                           var Prelude = Elm.Prelude(elm);
                           var Graphics = Graphics || {};
                           Graphics.Element = Elm.Graphics.Element(elm);
                           var Color = Elm.Color(elm);
                           var Graphics = Graphics || {};
                           Graphics.Collage = Elm.Graphics.Collage(elm);
                           var _op = {};
                           var execState = function (st)
                                           {
                                             return function ($)
                                                    {
                                                      return Basics.snd(st.runState($));
                                                    };
                                           };
                           var evalState = function (st)
                                           {
                                             return function ($)
                                                    {
                                                      return Basics.fst(st.runState($));
                                                    };
                                           };
                           var State = function (a)
                                       {
                                         return {_: {}, runState: a};
                                       };
                           var bindS = F2(function (st,f)
                                          {
                                            return State(function (s)
                                                         {
                                                           return function ()
                                                                  {
                                                                    var $ = st.runState(s),
                                                                        x = $._0,
                                                                        s$ = $._1;
                                                                    return f(x).runState(s$);
                                                                  }();
                                                         });
                                          });
                           var get = State(function (s)
                                           {
                                             return {ctor: "_Tuple2", _0: s, _1: s};
                                           });
                           var put = function (s$)
                                     {
                                       return State(function (s)
                                                    {
                                                      return {ctor: "_Tuple2", _0: {ctor: "_Tuple0"}, _1: s$};
                                                    });
                                     };
                           var updateS = function (f)
                                         {
                                           return A2(bindS,
                                                     get,
                                                     function (s)
                                                     {
                                                       return put(f(s));
                                                     });
                                         };
                           var returnS = function (x)
                                         {
                                           return State(function (s)
                                                        {
                                                          return {ctor: "_Tuple2", _0: x, _1: s};
                                                        });
                                         };
                           var fmapS = F2(function (f,st)
                                          {
                                            return A2(bindS,
                                                      st,
                                                      function (x)
                                                      {
                                                        return returnS(f(x));
                                                      });
                                          });
                           var sequenceS = function (ms)
                                           {
                                             return function ()
                                                    {
                                                      var k = F2(function (m,m$)
                                                                 {
                                                                   return A2(bindS,
                                                                             m,
                                                                             function (x)
                                                                             {
                                                                               return A2(bindS,
                                                                                         m$,
                                                                                         function (xs)
                                                                                         {
                                                                                           return returnS({ctor: "::", _0: x, _1: xs});
                                                                                         });
                                                                             });
                                                                 });
                                                      return A3(List.foldr,
                                                                k,
                                                                returnS(_J.toList([])),
                                                                ms);
                                                    }();
                                           };
                           var mapMS = function (f)
                                       {
                                         return function ($)
                                                {
                                                  return sequenceS(List.map(f)($));
                                                };
                                       };
                           elm.Public.State.State = {_op: _op, get: get, put: put, evalState: evalState, execState: execState, returnS: returnS, bindS: bindS, sequenceS: sequenceS, mapMS: mapMS, fmapS: fmapS, updateS: updateS, State: State};
                           return elm.Public.State.State;
                         };Elm.Public = Elm.Public || {};
Elm.Public.Vec2 = Elm.Public.Vec2 || {};
Elm.Public.Vec2.Vec2 = function (elm)
                       {
                         elm.Public = elm.Public || {};
                         elm.Public.Vec2 = elm.Public.Vec2 || {};
                         if (elm.Public.Vec2.Vec2)
                         return elm.Public.Vec2.Vec2;
                         var N = Elm.Native,
                             _N = N.Utils(elm),
                             _L = N.List(elm),
                             _E = N.Error(elm),
                             _J = N.JavaScript(elm),
                             _str = _J.toString,
                             $moduleName = "Public.Vec2.Vec2";
                         var Text = Elm.Text(elm);
                         var Text = Elm.Text(elm);
                         var Basics = Elm.Basics(elm);
                         var Signal = Elm.Signal(elm);
                         var List = Elm.List(elm);
                         var Maybe = Elm.Maybe(elm);
                         var Time = Elm.Time(elm);
                         var Prelude = Elm.Prelude(elm);
                         var Graphics = Graphics || {};
                         Graphics.Element = Elm.Graphics.Element(elm);
                         var Color = Elm.Color(elm);
                         var Graphics = Graphics || {};
                         Graphics.Collage = Elm.Graphics.Collage(elm);
                         var Transform2D = Elm.Transform2D(elm);
                         var _op = {};
                         var vecTranslate = function (v)
                                            {
                                              return A6(Transform2D.matrix,1,0,0,1,v.x,v.y);
                                            };
                         var scaleVec = F2(function (a,v)
                                           {
                                             return _N.replace([["x",v.x * a],["y",v.y * a]],v);
                                           });
                         var rotVec = F2(function (theta,v)
                                         {
                                           return function ()
                                                  {
                                                    var newY = v.x * Basics.sin(theta) + v.y * Basics.cos(theta);
                                                    var newX = v.x * Basics.cos(theta) - v.y * Basics.sin(theta);
                                                    return _N.replace([["x",newX],["y",newY]],v);
                                                  }();
                                         });
                         var origin = {_: {}, x: 0, y: 0};
                         var negVec = scaleVec(0 - 1);
                         var magnitude = function (v)
                                         {
                                           return Basics.sqrt(v.x * v.x + v.y * v.y);
                                         };
                         var magSquared = function (v)
                                          {
                                            return v.x * v.x + v.y * v.y;
                                          };
                         var fromIntPair = function (arg0)
                                           {
                                             return function ()
                                                    {
                                                      switch (arg0.ctor)
                                                      {case
                                                       "_Tuple2" :
                                                         return {_: {}, x: Basics.toFloat(arg0._0), y: Basics.toFloat(arg0._1)};}
                                                      _E.Case($moduleName,
                                                              "on line 31, column 23 to 51");
                                                    }();
                                           };
                         var extractVec = function (v)
                                          {
                                            return {_: {}, x: v.x, y: v.y};
                                          };
                         var dotVec = F2(function (v1,v2)
                                         {
                                           return v1.x * v2.x + v1.y * v2.y;
                                         });
                         var crossVecMag = F2(function (v1,v2)
                                              {
                                                return v1.x * v2.y - v1.y * v2.x;
                                              });
                         var addVec = F2(function (v1,v2)
                                         {
                                           return function ()
                                                  {
                                                    var newY = v1.y + v2.y;
                                                    var newX = v1.x + v2.x;
                                                    return _N.replace([["x",newX],["y",newY]],v2);
                                                  }();
                                         });
                         var addVec2 = addVec;
                         var midVec = F2(function (v1,v2)
                                         {
                                           return scaleVec(1 / 2)(A2(addVec,v1,v2));
                                         });
                         var subVec = function (v1)
                                      {
                                        return addVec(A2(scaleVec,0 - 1,v1));
                                      };
                         var distance = F2(function (v1,v2)
                                           {
                                             return magnitude(A2(subVec,v2,v1));
                                           });
                         var distanceSquared = F2(function (v1,v2)
                                                  {
                                                    return magSquared(A2(subVec,v2,v1));
                                                  });
                         var minimumDist = F3(function (v,w,p)
                                              {
                                                return function ()
                                                       {
                                                         var l2 = A2(distanceSquared,v,w);
                                                         return _N.eq(l2,
                                                                      0) ? {_: {}, offset: 0, r: A2(distance,
                                                                                                    v,
                                                                                                    p)} : function ()
                                                                                                          {
                                                                                                            var t = A2(dotVec,
                                                                                                                       A2(subVec,
                                                                                                                          v,
                                                                                                                          p),
                                                                                                                       A2(subVec,
                                                                                                                          v,
                                                                                                                          w)) / l2;
                                                                                                            var tFix = A3(Basics.clamp,
                                                                                                                          0,
                                                                                                                          1,
                                                                                                                          t);
                                                                                                            var r = _N.cmp(t,
                                                                                                                           0) < 0 ? A2(distance,
                                                                                                                                       p,
                                                                                                                                       v) : _N.cmp(t,
                                                                                                                                                   1) > 0 ? A2(distance,
                                                                                                                                                               p,
                                                                                                                                                               w) : function ()
                                                                                                                                                                    {
                                                                                                                                                                      var projection = addVec(v)(scaleVec(t)(A2(subVec,
                                                                                                                                                                                                                v,
                                                                                                                                                                                                                w)));
                                                                                                                                                                      return A2(distance,
                                                                                                                                                                                p,
                                                                                                                                                                                projection);
                                                                                                                                                                    }();
                                                                                                            return {_: {}, offset: tFix * Basics.sqrt(l2), r: r};
                                                                                                          }();
                                                       }();
                                              });
                         var sumVec = function ($)
                                      {
                                        return A2(List.foldl,
                                                  addVec,
                                                  origin)(List.map(extractVec)($));
                                      };
                         var Vec2Ext = F3(function (a,b,c)
                                          {
                                            return _N.insert("y",b,_N.insert("x",a,c));
                                          });
                         elm.Public.Vec2.Vec2 = {_op: _op, origin: origin, fromIntPair: fromIntPair, scaleVec: scaleVec, negVec: negVec, rotVec: rotVec, addVec: addVec, subVec: subVec, addVec2: addVec2, midVec: midVec, extractVec: extractVec, sumVec: sumVec, magnitude: magnitude, magSquared: magSquared, distance: distance, distanceSquared: distanceSquared, dotVec: dotVec, crossVecMag: crossVecMag, vecTranslate: vecTranslate, minimumDist: minimumDist, Vec2Ext: Vec2Ext};
                         return elm.Public.Vec2.Vec2;
                       };
        </script>
    </head>
    <body>
        <script type="text/javascript">
            Elm.fullscreen(Elm.Demo)
        </script>
        <noscript>
            
        </noscript>
    </body>
</html>
